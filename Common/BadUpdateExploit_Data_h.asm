

#---------------------------------------------------------
# Header for the data segment, contains pre-calculated addresses for all runtime data.
#---------------------------------------------------------

.macro EXPLOIT_DATA sym
    .set \sym,      RuntimeDataSegmentAddress + (_\sym - _data_segment_start)
.endm

# Symlink data:
EXPLOIT_DATA hdd_symlink_mount_str
EXPLOIT_DATA hdd_symlink_path_str
EXPLOIT_DATA hdd_symlink_mount
EXPLOIT_DATA hdd_symlink_path

EXPLOIT_DATA flash_symlink_mount_str
EXPLOIT_DATA flash_symlink_path_str
EXPLOIT_DATA flash_symlink_mount
EXPLOIT_DATA flash_symlink_path

# Misc data:
EXPLOIT_DATA smc_command_buffer
EXPLOIT_DATA read_file_bytes_read
EXPLOIT_DATA load_add_store_scratch
EXPLOIT_DATA read_file_handle
EXPLOIT_DATA read_file_size
EXPLOIT_DATA read_file_scratch

EXPLOIT_DATA pPayloadCipherText
EXPLOIT_DATA pPayloadCipherText2
EXPLOIT_DATA PayloadCipherTextPhysAddr
EXPLOIT_DATA pPayloadCipherTextSizeValue
EXPLOIT_DATA PayloadCipherTextSizeValuePhysAddr
EXPLOIT_DATA abOracleData
EXPLOIT_DATA BootAnimCodePagePhysAddr

EXPLOIT_DATA memcpy_cipher_text_src_addr
EXPLOIT_DATA memcpy_cipher_text_dst_addr
EXPLOIT_DATA memcpy_cipher_text_scratch

EXPLOIT_DATA flash_bootanim_path
EXPLOIT_DATA bootanim_module_handle

EXPLOIT_DATA new_task_attributes

.set EncryptedVirtualAddress,               0x8D000000
EXPLOIT_DATA CipherTextScratchBuffer
EXPLOIT_DATA pEncryptedVirtualAddress

EXPLOIT_DATA arithmetic_scratch1

# Secondary payload data:
.set second_stage_max_size,                 3 * 1024 * 1024     # 3MB max size
.set second_stage_offset,                   0x300
EXPLOIT_DATA second_stage_chain_address
EXPLOIT_DATA second_stage_chain_size
EXPLOIT_DATA secondary_payload_file_path

.set secondary_overwrite_loop_max_size,     1 * 1024 * 1024     # 1MB max size
EXPLOIT_DATA overwrite_loop_secondary_buffer_address
EXPLOIT_DATA overwrite_loop_secondary_buffer_size
EXPLOIT_DATA overwrite_loop_stack_address
EXPLOIT_DATA overwrite_cipher_text_stack_address

EXPLOIT_DATA memcmp_if_call_ptr

# Third stage payload data:
.set third_stage_max_size,                  0x00010000          # 64k max size
EXPLOIT_DATA third_stage_payload_file_path

# Misc debug data:
EXPLOIT_DATA data_segment_ptr
EXPLOIT_DATA test_file_path
EXPLOIT_DATA StatusToLedValues